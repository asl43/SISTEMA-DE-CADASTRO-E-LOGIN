<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema de Cadastro e Login por CPF</title>
<style>
  body {font-family: Arial, sans-serif; background: #0f1724; color: white; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0;}
  .container {background: #1e293b; padding: 20px; border-radius: 12px; box-shadow: 0 0 15px rgba(0,0,0,0.3); width: 320px;}
  h2 {text-align: center; color: #06b6d4;}
  input, button {width: 100%; padding: 10px; margin: 8px 0; border-radius: 8px; border: none;}
  input {background: #334155; color: white;}
  button {background: #06b6d4; color: white; cursor: pointer;}
  button:hover {background: #0891b2;}
  .hidden {display: none;}
</style>
</head>
<body>
<div class="container" id="cadastroContainer">
  <h2>Cadastro</h2>
  <input type="text" id="nome" placeholder="Nome completo" required>
  <input type="text" id="cpf" placeholder="CPF" required>
  <input type="email" id="email" placeholder="E-mail" required>
  <input type="date" id="nascimento" required>
  <input type="text" id="telefone" placeholder="Telefone" required>
  <button onclick="cadastrar()">Cadastrar</button>
  <p style="text-align:center;">Já tem conta? <a href="#" onclick="mostrarLogin()" style="color:#06b6d4;">Entrar</a></p>
</div>

<div class="container hidden" id="loginContainer">
  <h2>Login</h2>
  <input type="text" id="cpfLogin" placeholder="Digite seu CPF" required>
  <button onclick="login()">Entrar</button>
  <p style="text-align:center;">Não tem conta? <a href="#" onclick="mostrarCadastro()" style="color:#06b6d4;">Cadastre-se</a></p>
</div>

<div class="container hidden" id="sistemaContainer">
  <h2>Bem-vindo!</h2>
  <p id="dadosUsuario"></p>
  <button onclick="logout()">Sair</button>
</div>

<script>
const ENDPOINT_URL = 'https://script.google.com/macros/s/AKfycbzF1lPmnMulYuQZ7tX4nVot0E134VSRIZJbCUqOgUCGCaX0Fiy69H4noLOJLmzZRHw2/exec';

function mostrarLogin() {
  document.getElementById('cadastroContainer').classList.add('hidden');
  document.getElementById('loginContainer').classList.remove('hidden');
}

function mostrarCadastro() {
  document.getElementById('loginContainer').classList.add('hidden');
  document.getElementById('cadastroContainer').classList.remove('hidden');
}

function cadastrar() {
  const nome = document.getElementById('nome').value.trim();
  const cpf = document.getElementById('cpf').value.trim();
  const email = document.getElementById('email').value.trim();
  const nascimento = document.getElementById('nascimento').value;
  const telefone = document.getElementById('telefone').value.trim();

  if (!nome || !cpf || !email || !nascimento || !telefone) {
    alert('Preencha todos os campos!');
    return;
  }

  fetch(ENDPOINT_URL + '?action=register', {
    method: 'POST',
    body: JSON.stringify({ nome, cpf, email, nascimento, telefone }),
    headers: { 'Content-Type': 'application/json' }
  })
  .then(res => res.json())
  .then(data => {
    if (data.success) {
      alert('Cadastro realizado com sucesso!');
      mostrarLogin();
    } else {
      alert('Erro ao cadastrar: ' + (data.message || 'Tente novamente'));
    }
  })
  .catch(err => alert('Erro de conexão: ' + err.message));
}

function login() {
  const cpfLogin = document.getElementById('cpfLogin').value.trim();
  if (!cpfLogin) {
    alert('Digite seu CPF!');
    return;
  }

  fetch(ENDPOINT_URL + '?action=check&cpf=' + encodeURIComponent(cpfLogin))
    .then(res => res.json())
    .then(data => {
      if (data.found) {
        document.getElementById('loginContainer').classList.add('hidden');
        document.getElementById('sistemaContainer').classList.remove('hidden');
        document.getElementById('dadosUsuario').innerHTML = `CPF: ${data.data.cpf}<br>Nome: ${data.data.nome}<br>Email: ${data.data.email}`;
      } else {
        alert('CPF não encontrado. Cadastre-se primeiro.');
      }
    })
    .catch(err => alert('Erro ao verificar CPF: ' + err.message));
}

function logout() {
  document.getElementById('sistemaContainer').classList.add('hidden');
  mostrarLogin();
}
</script>
</body>
</html>
